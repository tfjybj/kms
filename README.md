# kms
ç”¨äºç®¡ç†ä¼šè®®å®¤å¯¹åº”çš„é’¥åŒ™ï¼Œå¦‚æœæœ‰ä½¿ç”¨ä¼šè®®å®¤çš„éœ€æ±‚å¯ä»¥ç›´æ¥å‘é€æ—¥ç¨‹æ¥å¯¹ä¼šè®®å®¤è¿›è¡Œä¸€ä¸ªä½¿ç”¨ã€‚ç³»ç»Ÿä¼šå¼¹å‡ºç”³è¯·ä¼šè®®å®¤å¯¹åº”çš„é’¥åŒ™ã€‚
## Kms é¡¹ç›®ä»‹ç»

**é¡¹ç›®èƒŒæ™¯**

äº†è§£åˆ°éƒ¨åˆ†å•ä½å¯¹äºé’¥åŒ™ç®¡ç†çš„è¿˜æ˜¯åœç•™åœ¨äººå·¥ç™»è®°çš„å±‚æ¬¡ï¼Œå¹¶ä¸”éœ€è¦æ¶ˆè€—å¤§é‡çš„çº¸å¼ è¿›è¡Œè®°å½•ï¼Œä¹Ÿä¼šå‡ºç°ä¸ç™»è®°é’¥åŒ™å°±éšæ„æ‹¿å–é’¥åŒ™çš„ç°è±¡ï¼Œé’¥åŒ™çš„å®‰å…¨æ€§ä¹Ÿä¸èƒ½å¾—åˆ°ä¿è¯ã€‚æ‰€ä»¥å°±æœ‰äº† kms çš„è¯ç”Ÿä»¥å¸®åŠ©ä»–ä»¬è§£å†³ä¸Šé¢æ‰€é‡åˆ°çš„é—®é¢˜ã€‚

**é¢å‘ç¾¤ä½“**

å…¬å¸ã€å•ä½å¯¹é’¥åŒ™è¿›è¡Œé›†ä¸­æ™ºèƒ½åŒ–ç®¡ç†çš„å›¢ä½“ã€‚

**æ ¸å¿ƒæ€æƒ³**

è‡ªåŠ¨åŒ–ï¼š

åˆ©ç”¨è½¯ç¡¬ä»¶ç»“åˆçš„æ–¹æ³•ï¼Œç”¨æˆ·åªéœ€è¦åœ¨æ‰‹æœºä¸Šé¢„å®šä¼šè®®å®¤ï¼Œç³»ç»Ÿä¼šä¸»åŠ¨æ¨é€é¢†å–é’¥åŒ™ã€å½’è¿˜é’¥åŒ™çš„æ¶ˆæ¯æé†’ï¼Œè®©ç”¨æˆ·æŠŠæ—¶é—´åˆ©ç”¨çš„æ›´å……åˆ†ã€‚

æ˜“ç®¡ç†ï¼š

æ‰€æœ‰é’¥åŒ™åšåˆ°ç»Ÿä¸€ç®¡ç†ï¼Œè„±ç¦»äººå·¥ç®¡ç†é’¥åŒ™ï¼Œå®ç°ç”¨æˆ·éšæ—¶å¯ä»¥æœ‰é’¥åŒ™ä½¿ç”¨ï¼Œé¢„çº¦ä¼šè®®å®¤åå³å¯é¢†å–ç›¸åº”çš„é’¥åŒ™ã€‚å‡å°‘äº†é’¥åŒ™ä¸¢å¤±çš„å¯èƒ½æ€§ã€‚

å®æ—¶æ€§ï¼š

ç”¨æˆ·å‘é€æ—¥ç¨‹é€‰æ‹©ä¼šè®®å®¤åï¼Œå¹¶å®æ—¶ç»™ç”¨æˆ·é€šè¿‡å®¡æ‰¹ï¼Œè¿˜ä¼šæŒ‰æ—¶æé†’ç”¨æˆ·é¢†å–é’¥åŒ™ã€å½’è¿˜é’¥åŒ™ï¼ŒèŠ‚çœäº†ç”¨æˆ·çš„æ—¶é—´ï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚

**äº§å“äº®ç‚¹**

ï¼‘ã€ç•Œé¢ç›´è§‚

é€šè¿‡æ¶ˆæ¯å¡ç‰‡çš„å½¢å¼æé†’ç”¨æˆ·åŠæ—¶é¢†å–ã€å½’è¿˜é’¥åŒ™ï¼Œå¹¶åœ¨ä¼šè®®å¼€å§‹å’Œç»“æŸå‰å¯¹ç”¨æˆ·è¿›è¡Œæ¶ˆæ¯æé†’ã€‚æé«˜ç”¨æˆ·çš„æ—¶é—´ç®¡ç†èƒ½åŠ›ã€‚

ï¼’ã€é«˜æ•ˆæ€§

ä¸ºäº†å‡å°‘äººå‘˜çš„è´Ÿæ‹…ï¼Œå¤§é‡çš„å·¥ä½œè¢«äº¤ç»™äº†å®¢æˆ·ç«¯æ¥å®ç°ï¼Œä»¥å‡å°‘äººå‘˜ç®¡ç†é’¥åŒ™çš„å‹åŠ›ï¼Œä¿è¯å·¥ä½œæ•ˆç‡çš„æé«˜ã€‚

**äº§å“æ¡†æ¶**

WCFã€JQuery

**å®é™…å±•ç¤ºï¼ˆæˆªå›¾æˆ–è§†é¢‘ï¼‰**

1ã€ç»™ç”¨æˆ·æ¨é€å‘¨æŠ¥

![ç»™ç”¨æˆ·æ¨é€å‘¨æŠ¥](https://img-blog.csdnimg.cn/dcc316da552340b9b4799e8d878f7a05.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_13,color_FFFFFF,t_70,g_se,x_16#pic_center))

æ¯å‘¨ä¸ºç”¨æˆ·æ¨é€ç”¨æˆ·çš„ä½¿ç”¨æƒ…å†µï¼Œå¹¶åœ¨å‘¨æŠ¥ä¸­ä½“ç°å‡ºç”¨æˆ·ä½¿ç”¨çš„æ¬¡æ•°ã€æ—¶é—´æ®µå’Œæ—¶é—´ã€‚

2ã€ç»™ç”¨æˆ·æ¨é€ä¼šè®®å®¤

![ç»™ç”¨æˆ·æ¨é€ä¼šè®®å®¤](https://img-blog.csdnimg.cn/5319937917224f22a63b4312a448690a.png#pic_center))

æ ¹æ®ä¼šè®®å†…å®¹ä»¥åŠæ—¶é•¿ä¸ºç”¨æˆ·æ¨é€å¯èƒ½ç¬¦åˆç”¨æˆ·éœ€è¦çš„ä¼šè®®å®¤ï¼Œå¦‚æœç”¨æˆ·è®¤ä¸ºå¯ä»¥ä½¿ç”¨è¿™ä¸ªä¼šè®®å®¤ï¼Œé‚£ä¹ˆå¯ä»¥ç”³è¯·ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨è¿™ä¸ªä¼šè®®å®¤ï¼Œç›´æ¥æ‹’ç»ï¼Œè¿˜ä¼šç»™ç”¨æˆ·æ¨é€ä¸‹ä¸€ä¸ªã€‚

3ã€![æé†’ç”¨æˆ·é¢†å–é’¥åŒ™](https://img-blog.csdnimg.cn/22bd8ccb063542d28a0c568c8a85e5e7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_19,color_FFFFFF,t_70,g_se,x_16#pic_center)

å½“ç”¨æˆ·ç”³è¯·å®Œä¼šè®®å®¤åï¼Œåœ¨ä¼šè®®å‰ 30 åˆ†é’Ÿä¼šæé†’ç”¨æˆ·é¢†å–é’¥åŒ™ã€‚

4ã€æé†’ç”¨æˆ·å½’è¿˜é’¥åŒ™

![æé†’ç”¨æˆ·å½’è¿˜é’¥åŒ™](https://img-blog.csdnimg.cn/c83ff8b167444626b09e97303889d329.png#pic_center)

åœ¨ä¼šè®®ç»“æŸå‰ 10 åˆ†é’Ÿï¼Œä¼šæé†’ç”¨æˆ·å½’è¿˜é’¥åŒ™ï¼Œä¹Ÿæ˜¯æé†’ç”¨æˆ·ä¼šè®®å®¤ä½¿ç”¨å¿«è¦åˆ°æœŸï¼Œæ³¨æ„æ—¶é—´æŠŠæ§ã€‚

5ã€æé†’ç”¨æˆ·æŠŠæ§æ—¶é—´

å½“ç”¨æˆ·è¶…å‡ºä¼šè®®æ—¶é•¿æ—¶ï¼Œä¼šæœ‰ç›¸åº”çš„ç§¯åˆ†æ‰£é™¤ï¼Œæé†’ç”¨æˆ·ä¸‹æ¬¡ä¼šè®®æ³¨æ„æŠŠæ§æ—¶é•¿ã€‚

**è”ç³»æˆ‘ä»¬ï¼š**

**æ‰‹æœºå·ï¼š18730628608\*\***ï¼ˆå¾®ä¿¡åŒæ­¥ï¼šæ­¦å…ˆç”Ÿï¼‰\*\*

**é‚®ç®±ï¼šw2402290237@163.com**

---

## åº”ç”¨åœºæ™¯

### ä»‹ç»

Kms ä¸»è¦æ˜¯ç”¨äºä¼šè®®å®¤é’¥åŒ™çš„ç®¡ç†ï¼Œä½†æˆ‘ä»¬æœ‰ä½¿ç”¨ä¼šè®®å®¤çš„éœ€æ±‚çš„æ—¶å€™å°±éœ€è¦é€šè¿‡å‘é€æ—¥ç¨‹æ¥å®Œæˆï¼Œå€Ÿç”¨ä¼šè®®å®¤å¹¶ä¸”æ‹¿åˆ°ä¼šè®®å®¤å¯¹åº”çš„é’¥åŒ™ã€‚

### æ—¶é—´

ä½¿ç”¨ä¼šè®®å®¤çš„å…·ä½“æ—¶é—´ï¼Œå¯ä»¥æå‰å‘é€æ—¥ç¨‹è¿›è¡Œä¼šè®®å®¤çš„é¢„çº¦ä¹Ÿå¯ä»¥éšæ—¶ä½¿ç”¨ä¼šè®®å®¤éšæ—¶å‘é€æ—¥ç¨‹ã€‚æ¯”å¦‚è¯´é¢„çº¦ä¼šè®®å®¤ï¼Œä»Šå¤©æ˜¯å‘¨äºŒï¼Œæˆ‘æƒ³å‘¨ä¸‰ä¸Šåˆ 8:00-9:00 ä½¿ç”¨ä¼šè®®å®¤ï¼Œé‚£åœ¨å‘é€æ—¥ç¨‹çš„æ—¶å€™é€‰æ‹©å‘¨ä¸‰å¯¹åº”çš„æ—¥æœŸé€‰æ‹© 8:00-9:00 å°±å®Œæˆäº†ä¼šè®®å®¤çš„é¢„çº¦ã€‚

![æ—¶é—´](https://img-blog.csdnimg.cn/5393d55fc2484014bcbe12f0dad951bb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

### åœ°ç‚¹

æ¯ä¸ªä¼šè®®å®¤å¯èƒ½å­˜åœ¨åŸºç¡€è®¾å¤‡çš„ä¸åŒï¼Œæ¯”å¦‚æœ‰çš„ä¼šè®®å®¤æœ‰ LED å¤§å±ï¼Œæœ‰çš„ä¼šè®®å®¤æœ‰ç™½æ¿ã€‚å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¼šè®®éœ€æ±‚æ¥é€‰æ‹©å¯¹åº”çš„ä¼šè®®å®¤ã€‚

![åœ°ç‚¹](https://img-blog.csdnimg.cn/030cf6f53af34ed7afbba18d7aedaabe.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

### äººç‰©

ä¼šè®®çš„ç»„ç»‡äººï¼Œå¯ä»¥æ·»åŠ ä¸Šä¼šè®®çš„å‚ä¸äººã€‚

![äººç‰©](https://img-blog.csdnimg.cn/457501732e2a41ff90bbecb5f412f1c9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

### è¡Œä¸º

1.  é€šè¿‡ç»„ç»‡ä¼šè®®ä½¿ç”¨ä¼šè®®å®¤
2.  é€šè¿‡æŠ€æœ¯åˆ†äº«ä½¿ç”¨ä¼šè®®å®¤
3.  é€šè¿‡å¸¦äººå‚è§‚ä½¿ç”¨ä¼šè®®å®¤
4.  ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚

---

## é¡¹ç›®éƒ¨ç½²æµç¨‹

ç¬¬ä¸€æ­¥ï¼Œé’‰é’‰åå°åˆ›å»ºæœºå™¨äººåº”ç”¨ä»¥åŠ h5 åº”ç”¨

ç¬¬äºŒæ­¥ï¼Œé…ç½®æœºå™¨äººåº”ç”¨ä»¥åŠ h5 åº”ç”¨çš„åº”ç”¨ä¿¡æ¯

1.é…ç½®æœºå™¨äººæ¶ˆæ¯æ¥æ”¶åœ°å€

![é…ç½®æœºå™¨äººæ¶ˆæ¯æ¥æ”¶åœ°å€](https://img-blog.csdnimg.cn/e2494bf17b7b4241b15ed112cdd7aed2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

æœºå™¨äººæƒé™

![æœºå™¨äººæƒé™](https://img-blog.csdnimg.cn/103b354619694d3abd5f762efc289eb3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

2.h5 åº”ç”¨ä¿¡æ¯é…ç½®

è¿™æ˜¯ä¸¤ä¸ªåº”ç”¨è¦é…ç½®çš„ä¿¡æ¯ï¼Œç”±äºè¿™ç³»ç»Ÿæ˜¯åœ¨é’‰é’‰çš„å¹³å°ä¸Šè¿›è¡Œå¼€å‘çš„ï¼Œéœ€è¦é’‰é’‰çš„å¾ˆå¤šåŠŸèƒ½ï¼Œæ¥ä¸‹æ¥ä¸€ä¸€åˆ—å‡ºæ‰€éœ€çš„æ¥å£ä»¥åŠæ³¨æ„äº‹é¡¹

æ¥å£éƒ¨åˆ†ï¼š

[é’‰é’‰ h5 åº”ç”¨é…ç½®äº‹ä»¶è®¢é˜…æ¥å£æ–‡æ¡£](https://open.dingtalk.com/document/org/configure-event-subcription)

![é’‰é’‰h5åº”ç”¨é…ç½®äº‹ä»¶è®¢é˜…æ¥å£æ–‡æ¡£](https://img-blog.csdnimg.cn/d0e603d9709b48e487a3c938193fecb7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

[å‘é€é’‰é’‰äº’åŠ¨å¡ç‰‡æ¥å£](https://open.dingtalk.com/document/robots/send-interactive-dynamic-cards)

è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹ï¼Œæœ¬ç³»ç»Ÿä½¿ç”¨çš„é’‰é’‰å¡ç‰‡å®ç°çš„ç”¨æˆ·äº’åŠ¨ï¼Œæ‰€ä»¥éœ€è¦å›è°ƒï¼Œåé¢ä¼šå±•ç¤ºå›è°ƒçš„éƒ¨åˆ†ã€‚

[é’‰é’‰äº’åŠ¨å¡ç‰‡å›è°ƒåœ°å€æ³¨å†Œæ¥å£](https://open.dingtalk.com/document/robots/register-an-interaction-card-callback-address)

[æ›´æ–°é’‰é’‰äº’åŠ¨å¡ç‰‡æ¥å£æ–‡æ¡£](https://open.dingtalk.com/document/robots/update-dingtalk-interactive-cards)

[é’‰é’‰å¡ç‰‡æ­å»ºå¹³å°](https://open.dingtalk.com/document/resourcedownload/card-building-platform)

æˆ‘ä»¬å¸¸ç”¨çš„å¡ç‰‡æ˜¯è‡ªå·±é€šè¿‡è¿™ä¸ªå¹³å°è®¾è®¡çš„

æ¥ä¸‹æ¥æ˜¯åœ¨ç¨‹åºä»£ç éƒ¨åˆ†çš„æ³¨æ„äº‹é¡¹äº†ï¼š

![ç¨‹åºä»£ç éƒ¨åˆ†æ³¨æ„äº‹é¡¹](https://img-blog.csdnimg.cn/9bdeb4f26fa84f8ea34ebd845f8d5291.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

è¿™ä¸ªç³»ç»Ÿæ˜¯ä½¿ç”¨çš„.net å¼€å‘çš„ï¼Œé€šè¿‡æŠŠè¿™ä¸ª webapi æœåŠ¡é€šè¿‡ iis å‘å¸ƒå°±å¯ä»¥æ¥å¯ä»¥æŠŠè¿™äº› api æ¥å£æ”¾åˆ°é’‰é’‰åå°åº”ç”¨é‡Œé¢ï¼Œè¿™å°±æ˜¯å‰é¢è¯´é’‰é’‰æœºå™¨äººå’Œ h5 åº”ç”¨æ”¾çš„ä¸¤ä¸ªåœ°å€éƒ½æ˜¯æºäºè¿™ä¸ªï¼Œä½†æ˜¯è¦æ³¨æ„äº†ä¸€å®šè¦æ˜¯å…¬ç½‘å¯è®¿é—®çš„æ¥å£æ‰è¡Œï¼Œå› ä¸ºæ˜¯é’‰é’‰é‚£è¾¹è°ƒç”¨ä½ çš„æ¥å£æ‰è¡Œã€‚

![å…¬ç½‘å¯è®¿é—®æ¥å£](https://img-blog.csdnimg.cn/604aaaf915ab4a08a7e45109bc208316.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

è¿™ä¸ªæ˜¯ä½¿ç”¨é’‰é’‰æ¥å£éœ€è¦çš„ä¿¡æ¯ï¼ŒæŠŠè¿™ä¸ªæ›´æ¢æˆè‡ªå·±çš„é’‰é’‰åå°åº”ç”¨çš„ä¿¡æ¯å³å¯ã€‚

ä»¥ä¸Šè¿™äº›æ˜¯å’Œé’‰é’‰äº¤äº’çš„ä¿¡æ¯ï¼Œä¸‹é¢ä»‹ç»ç¬¬ä¸‰æ­¥çš„åå°ç®¡ç†çš„é…ç½®ã€‚

ç¬¬ä¸‰æ­¥ï¼Œé…ç½®åå°ç®¡ç†æœåŠ¡

æˆ‘ä»¬ç¨‹åºåç«¯çš„é€»è¾‘å¤„ç†åœ¨è¿™é‡Œæ˜¯é€šè¿‡ wcf æœåŠ¡å®ç°çš„ï¼Œé€šè¿‡ webapi æœåŠ¡è¿™è¾¹å¼•ç”¨æœåŠ¡ï¼Œè¿™æ ·å°±å®ç°äº†æ¥å£å’Œåç«¯åˆ†ç¦»äº†ï¼Œè¿™ä¸ªä¹Ÿæ˜¯é€šè¿‡ iis å‘å¸ƒå³å¯ã€‚

ç¬¬å››æ­¥ï¼Œ æ•°æ®åº“é…ç½®

ç”±äºæˆ‘ä»¬è¿™ä¸ªç³»ç»Ÿæ˜¯é…åˆç€ç¡¬ä»¶æ¥ä½¿ç”¨çš„ï¼Œè€Œç¡¬ä»¶å…·æœ‰é™åˆ¶æ€§ï¼Œå°±éœ€è¦æœ‰ä¿¡æ¯çš„è®°å½•è¿™æ ·æ‰èƒ½åšåˆ°é’¥åŒ™ç®¡ç†è€Œä¸ä¼šå‡ºå·®é”™ï¼Œé€šè¿‡æ•°æ®åº“å­˜å‚¨æ¯ä¸€æ¬¡å¼€é”ä»¥åŠé’¥åŒ™é¢†å–çš„ä¿¡æ¯ã€‚

CREATE TABLE \`t_manager_record\` (

\`id\` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢',

\`manager_name\` varchar(10) NOT NULL COMMENT 'ç®¡ç†å‘˜å§“å',

\`key_name\` varchar(10) NOT NULL COMMENT 'é¢†å–é’¥åŒ™åç§°',

\`user_id\` varchar(30) NOT NULL COMMENT 'ç”¨æˆ·é’‰é’‰ ID',

\`get_time\` datetime DEFAULT NULL COMMENT 'é¢†å–æ—¶é—´',

\`is_return_key\` tinyint(2) DEFAULT NULL COMMENT 'æ˜¯å¦å½’è¿˜',

\`is_cancel\` tinyint(2) DEFAULT NULL COMMENT 'å¡ç‰‡æ˜¯å¦ä½œåºŸ',

\`create_time\` datetime NOT NULL COMMENT 'åˆ›å»ºæ—¶é—´',

\`update_time\` datetime DEFAULT NULL COMMENT 'ä¿®æ”¹æ—¶é—´',

\`get_out_track_id\` varchar(40) NOT NULL COMMENT 'é¢†å–é’¥åŒ™å¡ç‰‡æ¶ˆæ¯ ID',

\`return_out_track_id\` varchar(40) DEFAULT NULL COMMENT 'å½’è¿˜é’¥åŒ™å¡ç‰‡æ¶ˆæ¯ ID',

PRIMARY KEY (\`id\`)

) ENGINE=InnoDB AUTO_INCREMENT=37 DEFAULT CHARSET=utf8 COMMENT='ç®¡ç†å‘˜é¢†å–é’¥åŒ™è®°å½•è¡¨';

CREATE TABLE \`t_calendar\` (

\`id\` int(11) NOT NULL AUTO_INCREMENT COMMENT ' è‡ªå¢ id',

\`calendar_id\` text NOT NULL COMMENT 'æ—¥ç¨‹ ID',

\`content\` varchar(100) NOT NULL COMMENT 'å†…å®¹',

\`start_time\` datetime NOT NULL COMMENT 'ä¼šè®®å¼€å§‹æ—¶é—´',

\`end_time\` datetime NOT NULL COMMENT 'ä¼šè®®ç»“æŸæ—¶é—´',

\`return_time\` datetime DEFAULT NULL COMMENT 'é’¥åŒ™è¿”å›æ—¶é—´',

\`room_name\` varchar(10) DEFAULT NULL COMMENT 'æˆ¿é—´ ID',

\`attend_count\` varchar(100) NOT NULL COMMENT 'å‚ä¼šäºº',

\`organizer\` varchar(10) NOT NULL COMMENT 'ç»„ç»‡äºº',

\`approver\` varchar(30) DEFAULT NULL COMMENT 'å®¡æ‰¹äºº',

\`send_people\` varchar(30) DEFAULT NULL COMMENT 'æŠ„é€äºº',

\`organizer_id\` varchar(30) NOT NULL COMMENT 'ç»„ç»‡è€… dingid',

\`create_time\` datetime DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´',

\`update_time\` datetime DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´',

\`is_start\` tinyint(2) DEFAULT NULL COMMENT 'ä¼šè®®å¼€å§‹æ—¶é—´çš„çŠ¶æ€',

\`is_end\` tinyint(2) DEFAULT NULL COMMENT 'ä¼šè®®ç»“æŸæ—¶é—´çš„çŠ¶æ€',

\`out_track_id\` varchar(40) DEFAULT NULL COMMENT 'å”¯ä¸€æ ‡è¯†ä¸€æ¡å¡ç‰‡æ¶ˆæ¯çš„å¤–éƒ¨ç¼–ç ',

PRIMARY KEY (\`id\`)

) ENGINE=InnoDB AUTO_INCREMENT=543 DEFAULT CHARSET=utf8 COMMENT='æ—¥ç¨‹ä¿¡æ¯è¡¨';

CREATE TABLE \`t_room\` (

\`id\` int(11) NOT NULL AUTO_INCREMENT COMMENT 'è‡ªå¢ ID',

\`lock_number\` varchar(2) NOT NULL COMMENT 'é”ç¼–å·',

\`room_name\` varchar(10) NOT NULL COMMENT 'æ•™å®¤åç§°',

\`lock_state\` varchar(12) NOT NULL COMMENT 'é”çš„çŠ¶æ€',

\`front_min\` int(11) NOT NULL COMMENT 'å¼€é”å‰å¤šå°‘åˆ†é’Ÿå¯ä»¥å–é’¥åŒ™',

\`min_use_number\` int(11) DEFAULT NULL COMMENT 'æ•™å®¤æœ€å°‘ä½¿ç”¨äººæ•°',

\`create_time\` datetime DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´',

\`update_time\` datetime DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´',

PRIMARY KEY (\`id\`)

) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8 COMMENT='æˆ¿é—´ä¿¡æ¯è¡¨';

CREATE TABLE \`t_basicdata\` (

\`id\` int(11) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”® id',

\`room_name\` varchar(10) DEFAULT NULL COMMENT 'æ•™å®¤åç§°',

\`min_use_number\` int(4) DEFAULT NULL COMMENT 'è‡³å°‘ä½¿ç”¨äººæ•°',

\`before_take_key\` int(4) DEFAULT NULL COMMENT 'ä¼šè®®å¼€å§‹å‰\*åˆ†é’Ÿå–é’¥åŒ™',

\`after_return_key\` int(4) DEFAULT NULL COMMENT 'ä¼šè®®ç»“æŸå‰\*åˆ†é’Ÿè¿˜é’¥åŒ™',

\`upper_time\` int(11) DEFAULT NULL COMMENT 'ä¼šè®®å®¤ä½¿ç”¨æ—¶é—´ä¸Šé™',

\`lower_time\` int(11) DEFAULT NULL COMMENT 'ä¼šè®®å®¤ä½¿ç”¨æ—¶é—´ä¸‹é™',

\`approver\` varchar(10) DEFAULT NULL COMMENT 'å®¡æ‰¹äºº',

\`create_time\` datetime DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´',

\`update_time\` datetime DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´',

PRIMARY KEY (\`id\`) USING BTREE

) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT COMMENT='åŸºæœ¬æ•°æ®é…ç½®è¡¨';

---

## ç¡¬ä»¶é…ç½®

ç¡¬ä»¶ï¼š

æœåŠ¡å™¨ï¼š

ç³»ç»Ÿç¡¬ä»¶è¦æ±‚ï¼š

4 æ ¸å¿ƒ 4g å†…å­˜ 20g å‰©ä½™å­˜å‚¨ç©ºé—´

ç³»ç»Ÿè½¯ä»¶è¦æ±‚ï¼š

Linux å†…æ ¸ç³»ç»Ÿï¼ˆæ¨è CentOS7ï¼‰

é˜²ç«å¢™å¼€æ”¾ç«¯å£ï¼š

ç«¯å£å· mqtt é»˜è®¤ç«¯å£

ç«¯å£å· hivemq é¢æ¿

ç«¯å£å· homeassistant é¢æ¿

å…³äºè¿™ä¸ª hivemqã€homeassistant çš„é¢æ¿é…ç½®åœ¨è½¯ä»¶é…ç½®çš„å†…å®¹ä¸‹æœ‰ä¸“é—¨è¯´æ˜

ä¾‹å¦‚ï¼š

2094 mqtt é»˜è®¤ç«¯å£

ç”µæ§é”(è”ç½‘æ§åˆ¶)

ä¸²å£å·¥å…·ï¼ˆè®©ç”µæ§é”ä¸æœåŠ¡å™¨è¿›è¡Œä¸€ä¸ªç»‘å®šï¼Œé€šè¿‡æœåŠ¡å™¨è¿›è¡Œæ§åˆ¶ç”µæ§é”ï¼‰

ä»£ç ï¼š

è°ƒè¯•å¹³å° uiflow [https://docs.m5stack.com/zh_CN/quick_start/m5core/uiflow](https://docs.m5stack.com/zh_CN/quick_start/m5core/uiflow)

ä¸²å£æ•°æ®è¯´æ˜ [https://www.showdoc.com.cn/1014034257250686/7594958787627417](https://www.showdoc.com.cn/1014034257250686/7594958787627417)

ä»£ç å¼€å§‹

from m5stack import \*

from m5ui import \*

from uiflow import \*

import wifiCfg

from m5mqtt import M5mqtt

ChipMac = None

LockCtrlRawData = None

LockCtrlKey = None

wifiCfg.doConnect('æ— çº¿ç½‘ç»œåç§°', 'æ— çº¿å¯†ç ')

wifiCfg.reconnect()

def fun\_\_str_ChipMac\_\_\_\_str\_\_\_RawControlData\_\_\_\_(topic_data):

global ChipMac, LockCtrlRawData, LockCtrlKey

uart1.write(str(topic_data))

pass

def fun\_\_str_ChipMac\_\_\_\_str\_\_\_ControlData\_\_\_\_(topic_data):

global ChipMac, LockCtrlRawData, LockCtrlKey

if topic_data=='01':

LockCtrlRawData = 'comm,01,0110111100000060'

elif topic_data=='02':

LockCtrlRawData = 'comm,01,0210111100000027'

elif topic_data=='03':

LockCtrlRawData = 'comm,01,031011110000001A'

elif topic_data=='04':

LockCtrlRawData = 'comm,01,04101111000000A9'

elif topic_data=='05':

LockCtrlRawData = 'comm,01,0510111100000094'

elif topic_data=='06':

LockCtrlRawData = 'comm,01,06101111000000D3'

elif topic_data=='07':

LockCtrlRawData = 'comm,01,07101111000000EE'

elif topic_data=='08':

LockCtrlRawData = 'comm,01,08101111000000AC'

elif topic_data=='09':

LockCtrlRawData = 'comm,01,0910111100000091'

elif topic_data=='0a':

LockCtrlRawData = 'comm,01,0a101111000000D6'

elif topic_data=='0b':

LockCtrlRawData = 'comm,01,0b101111000000EB'

elif topic_data=='0c':

LockCtrlRawData = 'comm,01,0c10111100000058'

elif topic_data=='0d':

LockCtrlRawData = 'comm,01,0d10111100000065'

elif topic_data=='0e':

LockCtrlRawData = 'comm,01,0e10111100000022'

elif topic_data=='0f':

LockCtrlRawData = 'comm,01,0f1011110000001F'

elif topic_data=='10':

LockCtrlRawData = 'comm,01,10101111000000A6'

else:

LockCtrlRawData = '0000'

uart1.write(str(LockCtrlRawData))

pass

rgb.setBrightness(10)

rgb.setColorAll(0x990000)

\# æ ¹æ® stamp ä¸Šé¢çš„åœ°å€æ›´æ”¹ï¼Œç”¨äºåŒºåˆ†ä¸åŒæ¨¡å—

ChipMac = '94B97E921DA0'

uart1 = machine.UART(1, tx=32, rx=33)

uart1.init(115200, bits=8, parity=None, stop=1)

while not (wifiCfg.wlan_sta.isconnected()):

pass

rgb.setColorAll(0x000099)

m5mqtt = M5mqtt(ChipMac, 'æœåŠ¡å™¨åœ°å€', ç«¯å£å·, '', '', 300)

m5mqtt.subscribe(str(((str(ChipMac) + str('/RawControlData')))), fun\_\_str_ChipMac\_\_\_\_str\_\_\_RawControlData\_\_\_\_)

m5mqtt.subscribe(str(((str(ChipMac) + str('/ControlData')))), fun\_\_str_ChipMac\_\_\_\_str\_\_\_ControlData\_\_\_\_)

m5mqtt.start()

rgb.setColorAll(0x009900)

while True:

if uart1.any():

LockCtrlKey = (uart1.read()).decode()

m5mqtt.publish(str(((str(ChipMac) + str('/RawStatusData')))),str(LockCtrlKey))

\# åˆ¤æ–­æ˜¯å¦ä¸ºæ§åˆ¶ä¿¡å·

if LockCtrlKey\[0\] == 'c' and LockCtrlKey\[14\] == '1':

\# 1516 ä½

\# 10 ä¸ºå…³é”

\# 11 ä¸ºå¼€é”

if LockCtrlKey\[15\] == '1':

m5mqtt.publish(str(((str(ChipMac) + str('/StatusData')))),str(((str(((str(LockCtrlKey\[8\]) + str(LockCtrlKey\[9\])))) + str('isOpen')))))

else:

m5mqtt.publish(str(((str(ChipMac) + str('/StatusData')))),str(((str(((str(LockCtrlKey\[8\]) + str(LockCtrlKey\[9\])))) + str('isLock')))))

wait_ms(2)

ä»£ç ç»“æŸ

è½¯ä»¶

[ğŸ“2 å®‰è£… hivemq.txt](https://www.yuque.com/attachments/yuque/0/2022/txt/1448699/1645154597546-39c52d72-0582-47a6-bda2-77f4b91a311f.txt)[ğŸ“3 å®‰è£… homeassistant.txt](https://www.yuque.com/attachments/yuque/0/2022/txt/1448699/1645154597580-84c6ed9a-14d0-4792-89b3-088b58850fd8.txt)[ğŸ“1 å®‰è£… docker.txt](https://www.yuque.com/attachments/yuque/0/2022/txt/1448699/1645154597557-b5426664-c5aa-4447-bc45-471cbf9772bb.txt)

ä»¥ä¸Šæ“ä½œå®Œæˆä»¥åå¯é€šè¿‡å®‰è£… mqtt è°ƒè¯•è½¯ä»¶ï¼Œæ¨èä½¿ç”¨ mqttbox [https://github.com/workswithweb/MQTTBox](https://github.com/workswithweb/MQTTBox)

![é…ç½®mqttè¿æ¥](https://img-blog.csdnimg.cn/f30e8cfce7dd4cbe8cedfbc3816da986.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)

![é…ç½®è¿æ¥ä¹‹åé¡µé¢ä»‹ç»](https://img-blog.csdnimg.cn/b89a343a224a42b897dc5854e017092f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA546L5qKm5p2wLg==,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center)
